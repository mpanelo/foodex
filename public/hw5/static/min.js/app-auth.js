function createCookie(name,value,days){var expires="";if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toUTCString()}
document.cookie=name+"="+value+expires+"; path=/"}
function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)===0)return c.substring(nameEQ.length,c.length)}
return null}
function eraseCookie(name){createCookie(name,"",-1)}
var config={apiKey:"AIzaSyAPnQcQGlvVwpBLkKk49gjnw6EPuur7Pls",authDomain:"foodex-d5655.firebaseapp.com",databaseURL:"https://foodex-d5655.firebaseio.com",storageBucket:"foodex-d5655.appspot.com",messagingSenderId:"774577145729"};var app=firebase.initializeApp(config);var storage=app.storage();var db=app.database();window.onload=function(){const btnSignup=document.getElementById('btnSignup');if(btnSignup!=null){const signupUsername=document.getElementById('signupUsername');const signupEmail=document.getElementById('signupEmail');const signupPass=document.getElementById('signupPassword');const signupPass2=document.getElementById('signupPasswordRetype');btnSignup.addEventListener('click',e=>{console.log('signUp clicked');const email=signupEmail.value;const username=signupUsername.value;const pass=signupPass.value;const pass2=signupPass2.value;if(pass===pass2&&email!==""&&username!==""){const auth=firebase.auth();const promise=auth.createUserWithEmailAndPassword(email,pass);promise.catch(e=>console.log(e.code,e.message))}})}
const btnLogin=document.getElementById('btnLogin');if(btnLogin!=null){const loginEmail=document.getElementById('loginEmail');const loginPass=document.getElementById('loginPassword');btnLogin.addEventListener('click',e=>{console.log('login clicked');const email=loginEmail.value;const pass=loginPass.value;const auth=firebase.auth();const promise=auth.signInWithEmailAndPassword(email,pass);promise.catch(error=>{console.log(error.message);alert(error.message)})})}
const btnGoogleAuth=document.getElementById('btnGoogleAuth');if(btnGoogleAuth){var provider=new firebase.auth.GoogleAuthProvider();btnGoogleAuth.addEventListener('click',e=>{console.log('google login clicked');firebase.auth().signInWithRedirect(provider).then(function(){firebase.auth().getRedirectResult().then(function(result){if(!user){console.log('google: not logged in')}else{console.log('google:',user)}}).catch(function(error){console.log('google error caught:',error.code,error.message);alert(error.message)})})})}
const btnLogout=document.getElementById('btnLogout');if(btnLogout){btnLogout.addEventListener('click',e=>{console.log("logout clicked, logging out");firebase.auth().signOut();window.location='login.html'})}};firebase.auth().onAuthStateChanged(firebaseUser=>{console.log('auth state changed');if(firebaseUser){if(window.location.pathname=='/hw5/templates/login.html'){console.log("logging in as",firebaseUser.uid);window.location='main.html'}
else if(window.location.pathname=='/hw5/templates/signUp.html'){console.log("logging in as",firebaseUser.uid);window.location='main.html'}}else{if(window.location.pathname!='/hw5/templates/login.html'&&window.location.pathname!='/hw5/templates/signUp.html'){console.log("not logged in");window.location='login.html'}}})